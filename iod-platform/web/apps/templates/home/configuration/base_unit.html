{% extends "layouts/base.html" %}
{% load static %}

{% block title %} Base Unit Configuration {% endblock %} 

<!-- Specific CSS goes HERE -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}
    <!-- [ Main Content ] start -->
   <div class="pcoded-main-container">
    <div class="pcoded-wrapper">

        <div class="pcoded-content">
            <div class="pcoded-inner-content">
                <!-- [ breadcrumb ] start -->
                <div class="page-block">
                    <div class="row align-items-center">
                        <div class="col-md-12">
                            <div class="page-header-title">
                                <h5 class="m-b-10"></h5>
                            </div>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item"><a href="{% url 'networth'%}"><i class="feather icon-home"></i> Networth</a></li>
                                <li class="breadcrumb-item"><a href="{% url 'view_networth'%}"> Configuration</a></li>
                                <li class="breadcrumb-item"><a href="{% url 'view_base_unit' %}">Base Unit</a></li>
                                {% if is_edit %}
                                <li class="breadcrumb-item"><a href="javascript:">Edit</a></li>
                                {% endif %}
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- [ breadcrumb ] end --> 
                <div class="main-body">
                    <div class="page-wrapper">
                        <!-- [ Main Content ] start -->
                        <!-- If is_edit start -->
                        {% if is_edit %}
                        <!-- Edit Row  start -->
                        <div class="d-flex justify-content-center">
                            <div class="row">
                                <div class="card">
                                    <div class="card-body">
                                        <h5>Edit Base Unit</h5>
                                        <hr>
                                        <div class="form-container" >
                                            <form method="post" action="" class="needs-validation" novalidate>
                                                {% csrf_token %}
                                                <div class="form-group">
                                                    <label for="id_name">Base Unit Name:</label>
                                                    <input type="text" class="form-control" name="name" value="{%if form.name.value%}{{form.name.value}}{%endif%}" maxlength="200" required="" id="id_name">
                                                    <div class="invalid-feedback">
                                                        Please enter a valid name.
                                                    </div>
                                                    {% if form.errors.name %}
                                                        <div class="invalid-feedback" style="display: block;font-size: 85%;" >
                                                            <i class="feather icon-slack"></i>
                                                            {{ form.errors.name|join:", " }}
                                                        </div>
                                                    {% endif %}    
                                                </div>
                                                    <div class="form-group">
                                                        <label for="id_weightage">Value:</label>
                                                        <input type="text" class="form-control" name="value" value="{%if form.value.value%}{{form.value.value}}{%endif%}" required="" id="id_value">
                                                        <div class="invalid-feedback">
                                                            Please enter a valid value.
                                                        </div>
                                                        {% if form.errors.value %}
                                                            <div class="invalid-feedback" style="display: block;font-size: 85%;" >
                                                                <i class="feather icon-slack"></i> {{ form.errors.value|join:", " }}
                                                            </div>
                                                        {% endif %}
                                                    </div>
                                                    <div class="form-group">
                                                        <input type="submit" value="Submit" class="btn btn-primary">
                                                        <a href="{% url 'view_base_unit' %}" class="btn btn-secondary">Cancel</a>
                                                    </div>
                                            </form>
                                        </div>
                                    </div>
                                </div> 
                            </div>
                        </div>
                        <!-- Edit Row  end -->
                        <!-- If is_edit end -->
                        <!-- If not is_edit start -->
                        {% else %}
                        <!-- Summary Row  start -->
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="card">
                                    <div class="card-header">
                                        <h5>Base Units summary</h5>
                                    </div>
                                    <div class="card-block">
                                        <!-- Card block  start -->
                                        <!-- View Base Units Table start -->
                                        <div class="table-responsive">
                                            <!-- If GET Method starts-->
                                            {% if request.method == "GET" %}
                                                <!-- If base_units_list exists start-->    
                                                {% if  base_units_list %}
                                                    <!-- View base units table start-->    
                                                    <table class="table">
                                                        <thead>
                                                            <tr>
                                                                <th>#</th>
                                                                <th>Base Unit Name</th>
                                                                <th>Base Unit Value</th>
                                                                <th>Action</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <!-- View base units For Loop start-->    
                                                            {% for base_unit in base_units_list %}
                                                            <tr>
                                                                <th scope="row">{{forloop.counter}}</th>
                                                                <td data-id="{{baseunit.name}}" data-type="name">{{base_unit.name}}</td>
                                                                <td data-id="{{baseunit.value}}" data-type="weightage">{{base_unit.value}}</td>
                                                                
                                                                <td>
                                                                    <a class="btn btn-primary" href="{{base_unit.id}}/edit" type="submit">Edit</a>
                                                                    {% comment %} <form action="{{base_unit.id}}/delete" method="POST" style="display: inline-block;">
                                                                        {% csrf_token %}
                                                                        <button type="submit" class="btn btn-danger" style="width: 1px; height:42px">
                                                                            <i class="feather icon-trash-2"style="display: flex; justify-content: center; align-items: center;"></i>
                                                                            </button>
                                                                    </form> {% endcomment %}
                                                                    <!-- Delete confirmation modal starts-->
                                                                    <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
                                                                        <div class="modal-dialog" role="document">
                                                                        <div class="modal-content">
                                                                            <div class="modal-header">
                                                                            <h5 class="modal-title" id="deleteModalLabel">Confirm Delete</h5>
                                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                                <span aria-hidden="true">&times;</span>
                                                                            </button>
                                                                            </div>
                                                                            <div class="modal-body">
                                                                            Are you sure you want to delete this base unit?
                                                                            </div>
                                                                            <div class="modal-footer">
                                                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                                                            <button type="button" class="btn btn-danger" id="confirmDelete">Delete</button>
                                                                            </div>
                                                                        </div>
                                                                        </div>
                                                                    </div>
                                                                    <!-- Delete confirmation modal ends-->
                                                                </td>
                                                            </tr>
                                                            {% endfor %}
                                                            <!-- View base units For Loop end-->    
                                                        </tbody>
                                                    <!-- Else start If there are no base units for the user then show Add button-->        
                                                    {% else %}
                                                        <div class="text-center">
                                                            <a class="btn btn-primary" href="{% url 'create_base_unit' %}" type="submit">Add</a>
                                                        </div>
                                                    <!-- Else end If there are no base units for the user then show Add button-->
                                                {% endif %}
                                                <!-- If base_units_list exists ends-->  
                                                </table>
                                                <!-- View base units table ends-->
                                            {% endif %}
                                            <!-- If GET Method ends-->
                                        </div>
                                        <!-- View Base Units Table end -->
                                        <!-- Card block  end -->
                                    </div>
                                </div>
                            </div>    
                        </div>
                        <!-- Summary Row  End -->
                        {% endif %}
                        
                        
                        
                       
                         <!-- [ Main Content ] end -->
                    </div>
                </div>
            </div>
        </div>


{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}

<script src="{% static 'assets/js/plugins/bouncer.min.js' %}"></script>
<script src="{% static 'assets/js/pages/form-validation.js' %}"></script>

<script>
    $(function() {
      $('form').on('click', 'button.btn-danger', function() {
        $('#deleteModal').modal('show');
        var form = $(this).closest('form');
        $('#confirmDelete').on('click', function() {
          form.submit();
        });
        return false;
      });
    });
    
</script>
{% endblock javascripts %}